#!/bin/bash -x

. ./send_dtmf.sh
echo $0
echo $(dirname $0)
PWFILE=$(dirname $0)/password
if [ -s ${PWFILE} ]; then
   PASSWORD=$(cat ${PWFILE})
else
   echo "no password file"
   exit 1
fi

setup_gb3wx()
{
# password
send_dtmf ${PASSWORD} password

#send_dtmf *0060 "rx1->tx1_disa"
send_dtmf *0061 "rx1->tx1_disa"
send_dtmf *0071 "rx1->tx2_ena"
send_dtmf *0261 "rx2->tx1_ena"
#send_dtmf *0270 "rx2->tx2_disa"
send_dtmf *0271 "rx2->tx2_disa"

#
# courtesy tones are enabled by default on both transmitters
# see page 36 4.5 and page 37 4.6
#
#./dtmfgen -drate_convert -k*046 -t100
#./dtmfgen -drate_convert -k*047 -t100
#./dtmfgen -drate_convert -k*056 -t100
#./dtmfgen -drate_convert -k*057 -t100

send_dtmf *0461
send_dtmf *0471
send_dtmf *0561
send_dtmf *0571

#
# courtesy tone programming
# TODO
# change once we figure out what's going on
#
send_dtmf *7109931 R1T1-CT-D
send_dtmf *7119952 R1T2-CT-K
send_dtmf *7129953 R2T1-CT-L
send_dtmf *7139932 R2T2-CT-E

#
# save settings
# 0 is the power up group
#
send_dtmf \*10

#
# load power up settings
#
send_dtmf \*\*

# 
#
# leave privileged mode
#
send_dtmf \# quit
}

setup_gb3wx
